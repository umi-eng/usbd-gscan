//! Micorsoft OS Feature Descriptors

use usb_device::descriptor::descriptor_type;

/// Vendor code
pub const VENDOR_CODE: u8 = 0x20;

/// Descriptor string
#[rustfmt::skip]
pub const STRING_DESC: &[u8] = &[
    0x12, // length
    descriptor_type::STRING, // descriptor type
    b'M', 0, b'S', 0, b'F', 0, b'T', 0, b'1', 0, b'0', 0, b'0', 0, // 'MSFT100'
    VENDOR_CODE,
    0x00,
];

/// Compatible ID feature descriptor
#[rustfmt::skip]
pub const ID_FEATURE_DESC: &[u8] = &[
    0x10, 0x00, 0x00, 0x00, // length (0x00000010)
	0x00, 0x01,             // BCD version 1.0
	0x04, 0x00,             // feature description index (0x0004)
	0x02,                   // number of custom property sections
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // reserved

	0x00,                   // interface number
    0x01,                   // reserved
    b'W', b'I', b'N', b'U', b'S', b'B', 0x00, 0x00, // compatible id
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // sub-compatible id
    0x00, 0x00, 0x00, 0x00, // reserved
    0x00, 0x00,
    0x01,                   // interface number
    0x01,                   // reserved
    b'W', b'I', b'N', b'U', b'S', b'B', 0x00, 0x00, // compatible id
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // sub-compatible id
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // reserved
];

/// Extension property feature descriptor
#[rustfmt::skip]
pub const EXT_PROP_FEATURE_DESC: &[u8] = &[
   	0x92, 0x00, 0x00, 0x00, // length
	0x00, 0x01,             // version 1.0
	0x05, 0x00,             // descr index (0x0005)
	0x01, 0x00,             // number of sections

	0x88, 0x00, 0x00, 0x00, // property section size
	0x07, 0x00, 0x00, 0x00, // property data type 7: Unicode REG_MULTI_SZ
	0x2a, 0x00,             // property name length
	b'D', 0x00, b'e', 0x00, // property name "DeviceInterfaceGUIDs"
	b'v', 0x00, b'i', 0x00,
	b'c', 0x00, b'e', 0x00,
	b'I', 0x00, b'n', 0x00,
	b't', 0x00, b'e', 0x00,
	b'r', 0x00, b'f', 0x00,
	b'a', 0x00, b'c', 0x00,
	b'e', 0x00, b'G', 0x00,
	b'U', 0x00, b'I', 0x00,
	b'D', 0x00, b's', 0x00,
	b'\0', 0x00,
	0x50, 0x00, 0x00, 0x00, // property data length
	0x7b, 0x00, 0x63, 0x00, // property name: "{C15B4308-04D3-11E6-B3EA-6057189E6443}\0\0"
	0x31, 0x00, 0x35, 0x00,
	0x62, 0x00, 0x34, 0x00,
	0x33, 0x00, 0x30, 0x00,
	0x38, 0x00, 0x2d, 0x00,
	0x30, 0x00, 0x34, 0x00,
	0x64, 0x00, 0x33, 0x00,
	0x2d, 0x00, 0x31, 0x00,
	0x31, 0x00, 0x65, 0x00,
	0x36, 0x00, 0x2d, 0x00,
	0x62, 0x00, 0x33, 0x00,
	0x65, 0x00, 0x61, 0x00,
	0x2d, 0x00, 0x36, 0x00,
	0x30, 0x00, 0x35, 0x00,
	0x37, 0x00, 0x31, 0x00,
	0x38, 0x00, 0x39, 0x00,
	0x65, 0x00, 0x36, 0x00,
	0x34, 0x00, 0x34, 0x00,
	0x33, 0x00, 0x7d, 0x00,
	0x00, 0x00, 0x00, 0x00
];
